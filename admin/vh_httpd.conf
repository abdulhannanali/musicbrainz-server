# TODO: Set the IP address of your server here
<VirtualHost 1.2.3.4>
    # TODO: This needs to point to where the htdocs are
    DocumentRoot "/home/httpd/musicbrainz/htdocs"
    # TODO: This needs to point to where the cgi-bin scripts are
    Alias /cgi-bin/ "/home/httpd/musicbrainz/cgi-bin/"

    # TODO: Set your domain and the paths to your log files
    ServerName musicbrainz.yourdomain.org
    ServerAlias musicbrainz
    ErrorLog /var/log/musicbrainz_error_log
    CustomLog /var/log/musicbrainz-access_log common

    DefaultType text/html
    # TODO: This directory needs to be the same as DocumentRoot above
    <Directory /home/httpd/musicbrainz/htdocs>
       SetHandler perl-script
       PerlHandler HTML::Mason
    </Directory>

    <Location /cgi-bin>
       SetHandler  perl-script
       PerlHandler Apache::Registry
       Options +ExecCGI
    </Location>

    PerlModule Apache::DBI
    # TODO: Where to find the startup and handler scripts
    Perlrequire  /usr/apache/conf/startup.pl
    Perlrequire  /usr/apache/conf/handler.pl

    RewriteEngine on

    # Rules for mm-2.0
    RewriteRule   ^/artist/([^/]+)/(.*)  /cgi-bin/rdf.pl?query=artist&id=$1&depth=$2      [PT]
    RewriteRule   ^/artist/(.*)          /cgi-bin/rdf.pl?query=artist&id=$1               [PT]
    RewriteRule   ^/album/([^/]+)/(.*)   /cgi-bin/rdf.pl?query=album&id=$1&depth=$2       [PT]
    RewriteRule   ^/album/(.*)           /cgi-bin/rdf.pl?query=album&id=$1                [PT]
    RewriteRule   ^/track/([^/]+)/(.*)   /cgi-bin/rdf.pl?query=track&id=$1&depth=$2       [PT]
    RewriteRule   ^/track/(.*)           /cgi-bin/rdf.pl?query=track&id=$1                [PT]
    RewriteRule   ^/trmid/([^/]+)/(.*)   /cgi-bin/rdf.pl?query=trmid&id=$1&depth=$2       [PT]
    RewriteRule   ^/trmid/(.*)           /cgi-bin/rdf.pl?query=trmid&id=$1                [PT]
    RewriteRule   ^/trm/([^/]+)/(.*)     /cgi-bin/rdf.pl?query=trmid&id=$1&depth=$2       [PT]
    RewriteRule   ^/trm/(.*)             /cgi-bin/rdf.pl?query=trmid&id=$1                [PT]
    RewriteRule   ^/cdindex/([^/]+)/(.*) /cgi-bin/rdf.pl?query=cdindexid&id=$1&depth=$2   [PT]
    RewriteRule   ^/cdindex/(.*)         /cgi-bin/rdf.pl?query=cdindexid&id=$1            [PT]

    # Rules for mm-2.1
    RewriteRule   ^/mm-2.1/artist/([^/]+)/(.*)  /cgi-bin/rdf_2_1.pl?query=artist&id=$1&depth=$2      [PT]
    RewriteRule   ^/mm-2.1/artist/(.*)          /cgi-bin/rdf_2_1.pl?query=artist&id=$1               [PT]
    RewriteRule   ^/mm-2.1/album/([^/]+)/(.*)   /cgi-bin/rdf_2_1.pl?query=album&id=$1&depth=$2       [PT]
    RewriteRule   ^/mm-2.1/album/(.*)           /cgi-bin/rdf_2_1.pl?query=album&id=$1                [PT]
    RewriteRule   ^/mm-2.1/track/([^/]+)/(.*)   /cgi-bin/rdf_2_1.pl?query=track&id=$1&depth=$2       [PT]
    RewriteRule   ^/mm-2.1/track/(.*)           /cgi-bin/rdf_2_1.pl?query=track&id=$1                [PT]
    RewriteRule   ^/mm-2.1/trmid/([^/]+)/(.*)   /cgi-bin/rdf_2_1.pl?query=trmid&id=$1&depth=$2       [PT]
    RewriteRule   ^/mm-2.1/trmid/(.*)           /cgi-bin/rdf_2_1.pl?query=trmid&id=$1                [PT]
    RewriteRule   ^/mm-2.1/trm/([^/]+)/(.*)     /cgi-bin/rdf_2_1.pl?query=trmid&id=$1&depth=$2       [PT]
    RewriteRule   ^/mm-2.1/trm/(.*)             /cgi-bin/rdf_2_1.pl?query=trmid&id=$1                [PT]
    RewriteRule   ^/mm-2.1/cdindex/([^/]+)/(.*) /cgi-bin/rdf_2_1.pl?query=cdindexid&id=$1&depth=$2   [PT]
    RewriteRule   ^/mm-2.1/cdindex/(.*)         /cgi-bin/rdf_2_1.pl?query=cdindexid&id=$1            [PT]
</VirtualHost>  

%# vi: set ts=4 sw=4 ft=mason :
<%args>
$albumid => ""
</%args>
<%perl>

$m->comp("/comp/checkloggedin", 0, 1)
	or return;

MusicBrainz::IsNonNegInteger($albumid) && $albumid
	or return $m->comp("/comp/badargs", 0, 1);

my $mb = $m->comp("/comp/dblogin");

my $al = Album->new($mb->{DBH});
$al->SetId($albumid);
$al->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Album #$albumid not found",
		0, 1,
	);

my $ar = Artist->new($mb->{DBH});
$ar->SetId($al->GetArtist);
$ar->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Artist not found",
		0, 1,
	);

</%perl>

<& /comp/sidebar, title => "Album Details: " . $al->GetName &>

<& /comp/albuminfo, album => $al &>
<& /comp/artistinfo, artist => $ar &>

<& /comp/footer &>

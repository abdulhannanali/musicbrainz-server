<%perl>

my ($mb, $al, @albums);

$mb = new MusicBrainz;
$mb->Login();
$al = Album->new($mb->{DBH});
if (exists $ARGS{trackid})
{
   @albums = $al->GetAlbumIdsFromTrackId($ARGS{trackid});
}
else
{
   @albums = $al->GetAlbumIdsFromAlbumJoinId($ARGS{albumjoinid});
}
$mb->Logout();

$r->method('GET');
$r->headers_in->unset('Content-length');

$r->content_type('text/html');
$r->header_out(Location=>"/showalbum.html?albumid=$albums[0]");
$r->status(302);

</%perl>

<%perl>

my ($mb, $al, $album);

$mb = new MusicBrainz;
$mb->Login();
$al = Album->new($mb);
if (exists $ARGS{trackid})
{
   $album = $al->GetIdFromTrackId($ARGS{trackid});
}
else
{
   $album = $al->GetIdFromAlbumJoinId($ARGS{albumjoinid});
}
$mb->Logout();

$r->method('GET');
$r->headers_in->unset('Content-length');

$r->content_type('text/html');
$r->header_out(Location=>"/showalbum.html?albumid=$album");
$r->status(302);

</%perl>

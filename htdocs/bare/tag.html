<%args>
$album=>0
$url=>""
</%args>

<%perl>

if ($album > 0)
{
   my $list = "";

   $list = $session{tagged_albums} if (exists $session{tagged_albums});
   if (!($session{tagged_albums} =~ m/\b$album\b/))
   {
       # Adding album 0 clears the list
       if ($album == 0)
       {
           $list = ""; 
       }
       else
       {
           $list .= "$album " 
       }
   }
   else
   {
       $list =~ s/\b$album\b\s//;
   }
   $session{tagged_albums} = $list;
}

$r->method('GET');
$r->headers_in->unset('Content-length');
$r->content_type('text/html; charset=UTF-8');
$r->header_out(Location=>$url);
$r->status(302);

</%perl>

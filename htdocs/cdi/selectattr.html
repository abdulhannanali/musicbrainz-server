%# vi: set ts=4 sw=4 ft=mason :
<%perl>

$m->comp("check-all-entered", %ARGS) or return;

$m->comp("check-TracksNamedWithSequence", %ARGS) or return
	unless $ARGS{"force-TracksNamedWithSequence"};

$m->comp("check-macsac", %ARGS) or return
	unless $ARGS{"force-macsac"};

my ($key, $value, $mb, @attr);

$mb = mc_comp("/comp/dblogin");
mc_comp("/comp/sidebar", title=>'Select Album Attributes');

if ($ARGS{artist} == ModDefs::VARTIST_ID)
{
    @attr = (Album::ALBUM_ATTR_COMPILATION, Album::ALBUM_ATTR_OFFICIAL);
}
else
{
    @attr = (Album::ALBUM_ATTR_ALBUM, Album::ALBUM_ATTR_OFFICIAL);
}

my $selected_index = 0;

</%perl>

<form method="POST" action="/cdi/done.html" Name="SelectAttrs"
      enctype="application/x-www-form-urlencoded" class="formstyle">

<& /comp/albumattrform, mb=>$mb, albumname=>$ARGS{title}, 
						attrs=>\@attr, field1=>"attrtype", field2=>"attrstatus",
						selindex => \$selected_index &>

<%perl>
foreach $key (keys %ARGS)
{
   </%perl> 
   <input type="hidden" name="<% $key %>" value="<% $ARGS{$key} %>">
   <%perl> 
}
</%perl>
</form>

<& /comp/movefocus, "SelectAttrs", "attrtype", $selected_index &>

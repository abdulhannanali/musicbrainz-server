<%args>
$album
$artist
$showmodlinks=>1
</%args>
<%perl>

my $trackcount = $album->GetTrackCount();
my $trmids = $album->GetTrmidCount();
my $discids = $album->GetDiscidCount();
my @attrs = $album->GetAttributes();
my $modpend = $album->GetAttributeModPending();
my $lang_mod_pending = $album->GetLanguageModPending();
my $nonalbum = $album->IsNonAlbumTracks();

my $language = $album->GetLanguage;
my $script = $album->GetScript;

</%perl>

<table width="100%" cellpadding="0" cellspacing="0" border="0">
<tr><td width="90%">
<% $trackcount %> 
<img src="/images/notes.gif" align="middle" alt="Tracks" 
         width="13" height="13" style="vertical-align:bottom;border:0;"
         title="This album has <% $trackcount %> Tracks">

% if ($discids > 0) {
    &nbsp; &nbsp; &nbsp;<% $discids %>
    <img src="/images/cd.gif" align="middle" alt="CD" 
               width="13" height="13" style="vertical-align:bottom;border:0;"
               title="This album has <% $discids %> CD Index Ids">
% }
% if ($trmids > 0) {
    &nbsp; &nbsp; &nbsp;<% $trmids %>
    <img src="/images/trm.gif" align="middle" alt="TRM" 
               width="30" height="11" style="vertical-align:bottom;border:0;"
               title="This album has <% $trmids %> TRM Ids">&nbsp;
% }

% if (!$nonalbum) {

%   if ($language or $script) {

	<td NOWRAP>
[
	<span style="<% $lang_mod_pending ? 'background-color: #FFFFCC' : '' %>"><%
		$language ? $language->GetName() : "?" %>, <%
		$script ?  $script->GetName() : "?" %></span>
]

%				if ( $session{uid} and $showmodlinks ) {
  <a href="/edit/albumlanguage/edit.html?id=<% $album->GetId() %>"
   >Edit</a>&nbsp;|&nbsp;
%				}

%     } else {

%				if ( $session{uid} and $showmodlinks ) {
<td NOWRAP><a href="/edit/albumlanguage/edit.html?id=<% $album->GetId %>"
   >Edit language</a>&nbsp;
%				}

%     }

% }

<%perl>
if (!$nonalbum)
{
    $m->out("</td><td NOWRAP>[</td>");
    $m->out("<td NOWRAP>");
    $m->out("&nbsp;<a href=\"/popup/attrguide.html\" onclick=\"MyWindow=window.open('/popup/attrguide.html','AlbumAttributeGuide','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=400,height=275'); return false;\">");
    if (scalar(@attrs) > 0) 
    {
	      $m->out('<span style="background-color: #FFFFCC">') if $modpend;
	      my $count = 0;
        for my $attr (@attrs) 
        {
            $m->out(",&nbsp;") if ($count > 0);
            $m->out($album->GetAttributeName($attr));
            $count++;
        }
	      $m->out('</span>') if $modpend;
    }
    else
    {
        $m->out("None");
    }
    $m->out("</a>&nbsp;] ");

    if ($session{uid} and $showmodlinks) 
    {
        $m->out("<a href=\"/edit/album/editattributes.html?id=" . $album->GetId());
        $m->out("\">Edit</a>");
    }
}
</%perl>
</td></tr>
</table>

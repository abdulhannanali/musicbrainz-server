<%args>
$track
$album
$artist
$tindex
$hilitetrack
$hilitecolor
$nomod
$trmcount=>0
$mbtagger=>0
</%args>

<%perl>

my ($bgcolor, $tr_bgcolor, $colspan, $nonalbum);
$bgcolor = ($track->GetModPending()) ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"';
$bgcolor = ($hilitetrack == $track->GetId()) ? 'bgcolor="#FFCCFF"' : $bgcolor;
$tr_bgcolor = ($track->GetAlbumJoinModPending()) ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"';
my $ms = int((defined $track->GetLength()) ?  $track->GetLength() : -1);

my $secs = "?:??";
if ($ms > 0 && $ms < 1000) 
{
    $secs = "$ms ms"; 
}
elsif ($ms > 0)
{
    my $length_in_secs = $ms / 1000;
    $secs = int($length_in_secs / 60) . ":" . 
            sprintf("%02d",($length_in_secs % 60));
}
</%perl>

<tr>
% if (!$album->IsNonAlbumTracks()) {
%   $colspan=""; $nonalbum = 0;
    <td width="10%" align=center <% $tr_bgcolor |n %>>
       <% $track->GetSequence() %>
    </td>
% } else {
%   $colspan="colspan=\"2\"";
%   $nonalbum = 1;
% }
% if ($album->GetArtist() == &ModDefs::VARTIST_ID) {
    <td width="45%" <% $bgcolor |n %> <% $colspan %>>
% } else {
    <td width="75%" <% $bgcolor |n %> <% $colspan %>>
% }
% if ($mbtagger && !$nomod) {
    <a href="tag:<% $track->GetMBId() %>:<% $album->GetMBId() %>"><img src="/images/mblookup-tag.gif" 
       alt="Tag" title="Tag the current track" height="13" width="28"
       align="middle" border="0"></a>
% }
       <a href="/showtrack.html?trackid=<% $track->GetId %>"><% $track->GetName %></a>
% if ($trmcount > 0) {
       &nbsp;<img src="/images/trm.gif" align="middle" alt="TRM" width="30" 
                  height="11" title="<% $trmcount %> TRM Ids">&nbsp;
% }
    </td>
% if ($album->GetArtist() == &ModDefs::VARTIST_ID) {
    <td width="30%" bgcolor="white">
       <a href="/showartist.html?artistid=<% $track->GetArtist %>"><% $track->GetArtistName %></a>
% if (exists $session{user} and not $nomod) {
          (<a href="/changetrack.html?album=<% $album->GetId() %>&amp;tindex=<% $tindex %>&amp;solo=1">Change</a>)
% }
    </td>
% }
    <td width="10%" align="right" <% $tr_bgcolor |n %> nowrap>
       <% $secs %>
    </td>
% if (exists $session{user} && !$nomod) {
    <td width="15%" bgcolor="white" nowrap
    	class="CenterChildren" style="text-align: center"
	>
       <a href="/edittrack.html?track=<% $track->GetId() %>&amp;album=<% $album->GetId() %>">Edit</a>
% if ($album->CanRemoveTrack($track->GetSequence)) {
       | <a href="/remtrack.html?id=<% $track->GetId() %>&amp;album=<% $album->GetId() %>&amp;artist=<% $artist->GetId() %>">Del</a>
% }
    </td>
% }
</tr>

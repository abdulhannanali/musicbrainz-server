<%args>
$track
$album
$artist
$tindex
$lyricspresent
$hilitetrack
$hilitecolor
$nomod
$trmcount=>0
$mbtagger=>0
</%args>

<%perl>

my ($bgcolor, $tr_bgcolor, $length_in_secs);
$bgcolor = ($track->GetModPending()) ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"';
$bgcolor = ($hilitetrack == $track->GetId()) ? 'bgcolor="#FFCCFF"' : $bgcolor;
$tr_bgcolor = ($track->GetAlbumJoinModPending()) ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"';
$length_in_secs = int((defined $track->GetLength()) ? 
                      $track->GetLength() / 1000 : 0);

</%perl>

<tr>
    <td width="10%" align=center <% $tr_bgcolor |n %>>
       <% $track->GetSequence() %>
    </td>
% if ($album->GetArtist() == ModDefs::VARTIST_ID) {
    <td width="45%" <% $bgcolor |n %>>
% } else {
    <td width="75%" <% $bgcolor |n %>>
% }
% if ($mbtagger && !$nomod) {
    <a href="tag:<% $track->GetMBId() %>:<% $album->GetMBId() %>"><img src="/images/mblookup-tag.gif" 
       alt="Tag" title="Tag the current track" height="13" width="28"
       align="center" border="0"></a>
% }
% if ($lyricspresent == 1) {
       <a href="/showlyrics.html?id=<% $track->GetId() %>"><% $track->GetName() |h %></a>
% } else {
       <a href="/showtrack.html?trackid=<% $track->GetId() %>"><% $track->GetName() |h %></a>
% }
% if ($trmcount > 0) {
       &nbsp;<img src="/images/trm.gif" align="center" alt="TRM" width="30" 
                  height="11" title="<% $trmcount %> TRM Ids">&nbsp;
% }
    </td>
% if ($album->GetArtist() == ModDefs::VARTIST_ID) {
    <td width="30%" bgcolor="white">
       <a href="/showartist.html?artistid=<% $track->GetArtist() %>"><% $track->GetArtistName() |h  %></a>
% if (exists $session{user}) {
          (<a href="/changetrack.html?album=<% $album->GetId() %>&artist=<% $track->GetArtist() %>&tindex=<% $tindex %>&solo=1">Change</a>)
% }
    </td>
% }
    <td width="10%" align="right" <% $tr_bgcolor |n %> nowrap>
% if ($length_in_secs != 0) {
    <% int($length_in_secs / 60) %>:<% sprintf("%02d",($length_in_secs % 60)) %>
% }
    </td>
% if (exists $session{user} && !$nomod) {
    <td width="15%" align=center bgcolor="white" nowrap>
       <a href="/edittrack.html?id=<% $track->GetId() %>&album=<% $album->GetId() %>&artist=<% $artist->GetId() %>">Edit</a>
       | <a href="/remtrack.html?id=<% $track->GetId() %>&album=<% $album->GetId() %>&artist=<% $artist->GetId() %>">Del</a>
    </td>
% }
</tr>

<%args>
$track
$album
$artist
$tindex
$highlight
$highlightonly => 0
$showmodlinks
$trmcount=>0
$puidcount=>0
$mbtagger=>$session{'mbt'}
$showtrackartists=>0
</%args>
<%perl>

my $bgcolor = ($track->GetModPending ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"');
my $hl = ($highlight && ! $highlightonly);
$bgcolor = 'bgcolor="#FFCCFF"' if $hl;
my $tr_bgcolor = ($track->GetAlbumJoinModPending ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"');

my $isva = $album->HasMultipleTrackArtists || $showtrackartists;
my $nonalbum = $album->IsNonAlbumTracks;
my $colspan = ($nonalbum ? 'colspan="2"' : '');

</%perl>
<tr>
% unless ($nonalbum) {
    <td width="10%" align=center <% $tr_bgcolor |n %>>
%# Accessibility: if highlighting the track, don't /just/ use colours
       <% ($hl ? "**" : "") . $track->GetSequence . ($hl ? "**" : "") %>
    </td>
% }
% if ($isva) {
    <td width="45%" <% $bgcolor |n %> <% $colspan %>>
% } else {
    <td width="75%" <% $bgcolor |n %> <% $colspan %>>
% }
% if ($mbtagger && $showmodlinks and $track->GetId) {
    <a href="tag:<% $track->GetMBId() %>:<% $album->GetMBId() %>"><img src="/images/mblookup-tag.gif"
       alt="Tag" title="Tag the current track" height="13" width="28"
       align="middle" border="0"></a>
% }
% if ($track->GetId) {
       <a href="/track/<% $track->GetMBId %>.html"><% $track->GetName %></a>
% } else {
       <% $track->GetName %>
% }
% if (0 && $puidcount > 0) {
       &nbsp;<img src="/images/puid.png" align="middle" alt="PUID" width="40"
                  height="11" title="<% $puidcount %> PUIDs">&nbsp;
% }
% if ($trmcount > 0) {
       &nbsp;<img src="/images/trm.gif" align="middle" alt="TRM" width="30"
                  height="11" title="<% $trmcount %> TRM IDs">&nbsp;
% }
    </td>
% if ($isva) {
    <td width="30%" bgcolor="white">
       <a href="/showartist.html?artistid=<% $track->GetArtist %>"><% $track->GetArtistName %></a>
% if (exists $session{user} and $showmodlinks) {
          (<a href="/edit/track/change.html?album=<% $album->GetId() %>&amp;tindex=<% $tindex %>&amp;solo=1">Change</a>)
% }
    </td>
% }
    <td width="15%" align="right" <% $bgcolor |n %> nowrap>
       <% Track::FormatTrackLength($track->GetLength) %>
    </td>
% if ($session{uid} and $showmodlinks) {
    <td width="15%" bgcolor="white" nowrap
    	class="CenterChildren" style="text-align: center"
	>
       <a href="/edit/track/edit.html?track=<% $track->GetId() %>&amp;album=<% $album->GetId() %>">Edit</a>
% if ($album->CanRemoveTrack($track->GetSequence)) {
       | <a href="/edit/track/remove.html?id=<% $track->GetId() %>&amp;album=<% $album->GetId() %>&amp;artist=<% $artist->GetId() %>">Del</a>
% }
    </td>
% }
</tr>

<%args>
$track
$album
$artist
$tindex
$hilitetrack
$hilitecolor
$nomod
$trmcount=>0
$mbtagger=>$session{'mbt'}
</%args>
<%perl>

my $bgcolor = ($track->GetModPending ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"');
$bgcolor = ($hilitetrack == $track->GetId ? 'bgcolor="#FFCCFF"' : $bgcolor);
my $tr_bgcolor = ($track->GetAlbumJoinModPending ? 'bgcolor="#FFFFCC"' : 'bgcolor="#FFFFFF"');

my $nonalbum = $album->IsNonAlbumTracks;
my $colspan = ($nonalbum ? 'colspan="2"' : '');

</%perl>
<tr>
% unless ($nonalbum) {
    <td width="10%" align=center <% $tr_bgcolor |n %>>
       <% $track->GetSequence() %>
    </td>
% }
% if ($album->GetArtist() == &ModDefs::VARTIST_ID) {
    <td width="45%" <% $bgcolor |n %> <% $colspan %>>
% } else {
    <td width="75%" <% $bgcolor |n %> <% $colspan %>>
% }
% if ($mbtagger && !$nomod and $track->GetId) {
    <a href="tag:<% $track->GetMBId() %>:<% $album->GetMBId() %>"><img src="/images/mblookup-tag.gif" 
       alt="Tag" title="Tag the current track" height="13" width="28"
       align="middle" border="0"></a>
% }
% if ($track->GetId) {
       <a href="/showtrack.html?trackid=<% $track->GetId %>"><% $track->GetName %></a>
% } else {
       <% $track->GetName %>
% }
% if ($trmcount > 0) {
       &nbsp;<img src="/images/trm.gif" align="middle" alt="TRM" width="30" 
                  height="11" title="<% $trmcount %> TRM Ids">&nbsp;
% }
    </td>
% if ($album->GetArtist() == &ModDefs::VARTIST_ID) {
    <td width="30%" bgcolor="white">
       <a href="/showartist.html?artistid=<% $track->GetArtist %>"><% $track->GetArtistName %></a>
% if (exists $session{user} and not $nomod) {
          (<a href="/changetrack.html?album=<% $album->GetId() %>&amp;tindex=<% $tindex %>&amp;solo=1">Change</a>)
% }
    </td>
% }
    <td width="10%" align="right" <% $tr_bgcolor |n %> nowrap>
       <% Track::FormatTrackLength($track->GetLength) %>
    </td>
% if (exists $session{user} && !$nomod) {
    <td width="15%" bgcolor="white" nowrap
    	class="CenterChildren" style="text-align: center"
	>
       <a href="/edittrack.html?track=<% $track->GetId() %>&amp;album=<% $album->GetId() %>">Edit</a>
% if ($album->CanRemoveTrack($track->GetSequence)) {
       | <a href="/remtrack.html?id=<% $track->GetId() %>&amp;album=<% $album->GetId() %>&amp;artist=<% $artist->GetId() %>">Del</a>
% }
    </td>
% }
</tr>

<%args>

	$handlearguments => 0

</%args>
<%perl>

	$m->comp("/search/handle-searchsession.inc", %ARGS)
		if ($handlearguments);

	my $oldsearch = '/search/oldsearch.html';

</%perl>

<form method="get" action="/search/textsearch.html" class="formstyle" id="TextSearchForm">
	<table class="formstyle" style="width: 100%">
		<tr class="top">
			<td class="labelnopad">
				<label for="id_query">Search for:</label></td>
			<td>
				<input type="text" name="query" id="id_query" value="<% $session{"as_query"} %>" size="30" />
			</td>
		</tr>
		<tr class="top">
			<td class="labelnopad"><label for="id_type">Type:</label></td>
			<td style="width: 350px">
				<select name="type" id="id_type">
%					$m->out(qq!<option value="artist" ! . ($session{"as_type"} eq "artist" ? 'selected="selected"' : '') . qq!>Artists</option>!);
%					$m->out(qq!<option value="release" ! . ($session{"as_type"} eq "release" ? 'selected="selected"' : '') . qq!>Releases</option>!);
%					$m->out(qq!<option value="track" ! . ($session{"as_type"} eq "track" ? 'selected="selected"' : '') . qq!>Tracks</option>!);
				</select>
			</td>
		</tr>
		<tr class="top">
			<td class="labelnopad"></td>
			<td style="width: 350px">
				<table cellspacing="0" cellpadding="0" border="0">
					<tr id="id_type_a">
						<td>

%	my ($as_an, $as_as, $as_aa) = ($session{"as_an"}, $session{"as_as"}, $session{"as_aa"});
%	$as_an = defined ($as_an) ? $as_an : 1;
%	$as_as = defined ($as_as) ? $as_as : 1;
%	$as_aa = defined ($as_aa) ? $as_aa : 0;

							in <input type="checkbox" name="an" value="1"
								<% $as_an ? qq! checked="checked" ! : "" |n %>
							/>&nbsp;Names

							<input type="checkbox" name="as" value="1"
								<% $as_as ? qq! checked="checked" ! : "" |n %>
							/>&nbsp;Sort Names

							<input type="checkbox" name="aa" value="1"
								<% $as_aa ? qq! checked="checked" ! : "" |n %>
							/>&nbsp;Aliases
						</td>
					</tr>
					<tr id="id_type_r">
						<td colspan="2">using release&nbsp;name fields</td>
					</tr>
					<tr id="id_type_t">
						<td colspan="2">using track&nbsp;name fields</td>
					</tr>
				</table>
            </td>
		</tr>
		<tr>
			<td class="labelnopad"><label for="id_limit">Limit to:</label></td>
			<td>
				<select name="limit" id="id_limit">
%					$m->out(qq!<option value="25" ! . ($session{"as_limit"} eq 25 ? 'selected="selected"' : '') . qq!>Up to 25</option>!);
%					$m->out(qq!<option value="50" ! . ($session{"as_limit"} eq 50 ? 'selected="selected"' : '') . qq!>Up to 50</option>!);
%					$m->out(qq!<option value="100" ! . ($session{"as_limit"} eq 100 or $session{"as_limit"} eq 0 ? 'selected="selected"' : '') . qq!>Up to 100</option>!);
			  	</select></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>
				<input type="submit" value="Indexed Search &raquo;" title="Start search..." />
				<input type="submit" name="submitvalue" value="Reset" title="Reset search parameters" />
				<input type="hidden" name="handlearguments" value="1" /></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>
				[ <a href="<% $oldsearch %>" title="Search for the same query using the Direct Search...">direct search</a> ]&nbsp;&nbsp;[ <a href="/popup/TextSearchSyntax" title="POPUP::TextSearchSyntax::400::400">help</a> ]

				<div id="id_querysyntax" style="display: none">
					<& /comp/form/feedbackbox, "warning", "Possible query syntax detected:",
						qq!Your query includes punctuation that may be interpreted as !
						.$m->scomp("/comp/linkdoc", "TextSearchSyntax", "query syntax")
						.qq!. (Hint: A list of characters which trigger this warning
							  message are <code>:?\!~[]{}()+ </code>)!,
					&>
				</div>

			</td>
		</tr>
	</table>
</form>

<script type="text/javascript" src="/scripts/search-lucene.js"></script>

%# vi: set ts=4 sw=4 ft=mason :

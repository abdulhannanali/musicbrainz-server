<%args>

	$handlearguments => 0

</%args>
<%perl>

	$m->comp("/search/handle-searchsession.inc", %ARGS)
		if ($handlearguments);

	my $oldsearch = '/search/oldsearch.html';

</%perl>

<form method="get" action="/search/textsearch.html" class="formstyle" id="TextSearchForm">
	<table class="formstyle">
		<tr>
			<td class="labelnopad">
				<label for="id_query">Search for:</label></td>
			<td>
				<input type="text" name="query" id="id_query" value="<% $session{"as_query"} %>" size="30" />
			</td>
		</tr>
		<tr>
			<td class="labelnopad"><label for="id_type">Type:</label></td>
			<td style="width: 350px">
				<select name="type" id="id_type">
%					$m->out(qq!<option value="artist" ! . ($session{"as_type"} eq "artist" ? 'selected="selected"' : '') . qq!>Artists</option>!);
%					$m->out(qq!<option value="release" ! . ($session{"as_type"} eq "release" ? 'selected="selected"' : '') . qq!>Releases</option>!);
%					$m->out(qq!<option value="track" ! . ($session{"as_type"} eq "track" ? 'selected="selected"' : '') . qq!>Tracks</option>!);
%					$m->out(qq!<option value="annotation" ! . ($session{"as_type"} eq "annotation" ? 'selected="selected"' : '') . qq!>Annotations</option>!);
%					$m->out(qq!<option value="freedb" ! . ($session{"as_type"} eq "freedb" ? 'selected="selected"' : '') . qq!>FreeDB</option>!);
				</select>
			</td>
		</tr>
		<tr>
			<td class="labelnopad"><label for="id_limit">Limit to:</label></td>
			<td>
				<select name="limit" id="id_limit">
%                   $session{"as_limit"} = 25 if ($session{"as_limit"} <= 0);
%					$m->out(qq!<option value="25" ! . ($session{"as_limit"} eq 25 ? 'selected="selected"' : '') . qq!>Up to 25</option>!);
%					$m->out(qq!<option value="50" ! . ($session{"as_limit"} eq 50 ? 'selected="selected"' : '') . qq!>Up to 50</option>!);
%					$m->out(qq!<option value="100" ! . ($session{"as_limit"} eq "100" ? 'selected="selected"' : '') . qq!>Up to 100</option>!);
			  	</select></td>
		</tr>
		<tr>
			<td class="labelnopad"><label for="id_adv">Method:</label></td>
			<td style="width: 350px">
				<input type="checkbox" name="adv" id="id_adv" <% ($session{"as_adv"} ? 'checked="checked"' : '') %>/>
                Use advanced <a href="/popup/TextSearchSyntax" title="POPUP::TextSearchSyntax::400::400">query syntax</a>
			</td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>
				<input type="submit" value="Indexed search &raquo;" title="Start search..." />
				<input type="submit" name="submitvalue" value="Reset" title="Reset search parameters" />
				<input type="hidden" name="handlearguments" value="1" /></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>
				[ <a href="<% $oldsearch %>" title="Search for the same query using the direct search...">direct search</a> ]&nbsp;&nbsp;[ <a href="/popup/TextSearchSyntax" title="POPUP::TextSearchSyntax::400::400">help</a> ]
			</td>
		</tr>
	</table>
</form>

%# vi: set ts=4 sw=4 ft=mason :

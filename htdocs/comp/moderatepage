<%perl>

my ($mb, @info, $row, $offset, $i, $num_mods, $comp, $mod);
my $max_items = 25;

$mb = new MusicBrainz;  

mc_comp("/comp/title", title=>'Review Pending Moderations'); 

$offset = $ARGS{offset};
$offset = 0 if not defined $offset;
$offset = 0 if $offset < 0;  

$mb->Login();
$mod = Moderation->new($mb);
($num_mods, @info) = $mod->GetModerationList($offset, $max_items, $session{uid});
$mb->Logout();

</%perl>

<form method="POST" action="/bare/vote.html"
      enctype="application/x-www-form-urlencoded" class="formstyle"> 

<table width=100%>
<tr>
  <td align=right>
     Click here to vote on the items on this page:
     <INPUT TYPE="submit" NAME="Submit" VALUE="Submit">
  </td>
</tr>
</table>

<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0"
       BGCOLOR="#000000" WIDTH="100%">
<TR><TD>
  <TABLE WIDTH="100%" BORDER="0" CELLSPACING="1" CELLPADDING="3">
  <TR>
    <& /comp/thcell, text=>'Field' &>
    <& /comp/thcell, text=>'Old Value' &>
    <& /comp/thcell, text=>'New Value' &>
    <& /comp/thcell, text=>'Votes Yes/No' &>
    <& /comp/thcell, text=>'Vote Yes' &>
    <& /comp/thcell, text=>'Vote No' &>
    <& /comp/thcell, text=>'Abstain' &>
  </TR>

<%perl>
for($i = 0; ; $i++) 
{
   $row = $info[$i];
   last if (!defined $row);

   mc_comp("/comp/showmod",
           id=>($$row[0]),
           table=>($$row[1]),
           column=>($$row[2]),
           rowid=>($$row[3]),
           prev=>($$row[4]),
           new=>($$row[5]),
           time=>($$row[6]),
           moderator=>($$row[7]),
           yesvotes=>($$row[8]),
           novotes=>($$row[9]),
           voted=>($$row[10]));
}
</%perl>

% if ($num_mods > $max_items) {
<tr><td colspan=7 bgcolor=white>

<& /comp/prevnextbuttons, 
   url=>"moderate.html",
   offset=>$offset,
   itemsperpage=>$max_items,
   totalitems=>$num_mods
&>
</td></tr>
% }

</table>

</TD></TR>
</TABLE><BR><P> 

</form>

<table>
<tr><td colspan=2>
  Legend:
</td></tr>

<tr><td align=center width="10%">
<b>N/A</b>
</td><td>
Vote not allowed. (You're not allowed to vote on your own mods).
</td></tr>

<tr><td align=center>
<b>--</b>
</td><td>
Already voted.
</td></tr>
</table>


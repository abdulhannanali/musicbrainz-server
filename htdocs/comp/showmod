<%args>
$mod
$mode
$notes
</%args>

<%perl>

my ($ref, $obj, $bold);
my $voted = $mod->GetVoteId();
my $text = "(Your change)";
if ($voted)
{
   $text = "(Already voted)";
}
my @entered = gmtime($mod->GetExpireTime());
my $time = sprintf "%d-%02d-%02d %02d:%02d", 
              $entered[5] + 1900,
              $entered[4]+1, 
              $entered[3], 
              $entered[2], $entered[1];

</%perl>

<tr>
<td bgcolor="#FFBA58" colspan=3><img src="/images/pixel.gif" width="1" height="1" alt="" border=""></td>
</tr>
<tr>
   <td width=37% valign=top bgcolor=white class="body">
     By: <span class="bold"><% $mod->GetModeratorName() |n %></span>
     &nbsp;&nbsp;&nbsp;
     Id: <% $mod->GetId() %><br> 
     Expires: <% $time |n %>
   </td>
   <td width=37% valign=top bgcolor=white class="body">
     <% $mod->ShowModType() |n %> 
   </td>
   <td width=30% align=center valign=top valign=top bgcolor=white class="body">
     <% $mod->GetYesVotes() |n %> yes,
     <% $mod->GetNoVotes() |n %> no
% if ($mode == ModDefs::TYPE_NEW || $mode == ModDefs::TYPE_MINE) {
     &nbsp;&nbsp; 
     <a href="#" onClick="MyWindow=window.open('mod/addnote.html?modid=<% $mod->GetId() %>','AddNote','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=400,height=150'); return false;"><img align="center" src="/images/note.gif" border="0" alt="Add a note"></a>
% }
   </td>
</tr>
<tr>
   <td width=37% valign=top bgcolor=white class="body">
     <% $mod->ShowPreviousValue() |n %> 
   </td>
   <td width=37% valign=top bgcolor=white class="body">
     <% $mod->ShowNewValue() |n %> 
   </td>
   <td width=30% align=center valign=top bgcolor=white class="body">
% if ($mode == ModDefs::TYPE_MINE) {
     <% $mod->GetChangeName() |n %>
% } elsif ($mode == ModDefs::TYPE_VOTED) {
     <% $mod->GetVoteText($voted) |n %>
     (<% $mod->GetChangeName() |n %>)
% } elsif (($session{user} ne $mod->GetModerator() && !$voted) || 
%          DBDefs::ALLOW_SELF_VOTE) {
     Yes&nbsp;<input type="radio" name="rowid<% $mod->GetId() %>" value="yes">&nbsp;No&nbsp;<input type="radio" name="rowid<% $mod->GetId() %>" value="no">&nbsp;Abst&nbsp;<input type="radio" name="rowid<% $mod->GetId() %>" value="abs" CHECKED>
% } else {
     <% $text %> 
% }
   </td>
</tr>

% if (exists $notes->{ $mod->GetId() }) {
<tr>
   <td colspan="3" valign=top bgcolor=white class="body">
%    $ref = $notes->{ $mod->GetId() };
     Notes:<br>
%    foreach $obj (@$ref) {
        &nbsp;&nbsp;&nbsp;&nbsp;
%       $bold = ($obj->{user} eq $mod->GetModeratorName()) ? 'bold' : 'body';
        <font class="<% $bold %>"><% $obj->{user} %></font>:
        <% $obj->{text} %><br> 
%    }
   </td>
</tr>
% }

<%args>
$mod
$notes
</%args>

<%perl>

my ($ref, $obj, $bold);
my $voted = $mod->GetVote();
my $text = "(Your change)";
if ($voted != ModDefs::VOTE_UNKNOWN && $voted != ModDefs::VOTE_NOTVOTED)
{
   $text = "(Already voted)";
}
my @entered = gmtime($mod->GetExpireTime());
my $time = sprintf "%d-%02d-%02d %02d:%02d", 
              $entered[5] + 1900,
              $entered[4]+1, 
              $entered[3], 
              $entered[2], $entered[1];

</%perl>

<tr>
<td bgcolor="#FFBA58" colspan=3><img src="/images/pixel.gif" width="1" height="1" alt="" border=""></td>
</tr>
<tr>
   <td width=37% valign=top bgcolor=white class="body">
     By: <span class="bold"><% $mod->GetModeratorName() |n %></span>
     &nbsp;&nbsp;&nbsp;
     <a href="/showmod.html?modid=<% $mod->GetId() %>"
        title="View moderation detail">Id: <% $mod->GetId() %></a><br> 
     Expires: <% $time |n %>
   </td>
   <td width=37% valign=top bgcolor=white class="body">
     <% $mod->ShowModType() |n %> 
   </td>
   <td width=30% align=center valign=top valign=top bgcolor=white class="body">
     <% $mod->GetYesVotes() |n %> yes,
     <% $mod->GetNoVotes() |n %> no
     &nbsp;&nbsp; 
     <a href="#" onClick="MyWindow=window.open('mod/addnote.html?modid=<% $mod->GetId() %>','AddNote','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=400,height=150'); return false;"><img align="center" src="/images/note.gif" border="0" alt="Add a note"></a>
   </td>
</tr>
<tr>

   <td width=37% valign=top bgcolor="#ffecd6" class="body">
     <% $mod->ShowPreviousValue() |n %> 
   </td>

   <td width=37% valign=top bgcolor="#f0efff" class="body">
     <% $mod->ShowNewValue() |n %> 
   </td>

   <td width=30% align=center valign=top bgcolor=white class="body">

% if ($session{uid} == $mod->GetModerator()) {
     <% $mod->GetChangeName() |n %>
% } elsif ($voted == ModDefs::VOTE_YES || $voted == ModDefs::VOTE_NO ||
%          $voted == ModDefs::VOTE_ABS) {
     <% $mod->GetVoteText($voted) |n %> -- <% $mod->GetChangeName() |n %>
% } elsif ($session{uid} != $mod->GetModerator() && 
%          $voted == ModDefs::VOTE_NOTVOTED) {
     Yes&nbsp;<input type="radio" name="rowid<% $mod->GetId() %>" value="yes">&nbsp;No&nbsp;<input type="radio" name="rowid<% $mod->GetId() %>" value="no">&nbsp;Abst&nbsp;<input type="radio" name="rowid<% $mod->GetId() %>" value="abs" CHECKED>
% } else {
     <% $text %> 
% }
   </td>

</tr>

% if (exists $notes->{ $mod->GetId() }) {
<tr>
   <td colspan="3" valign=top bgcolor=white class="body">
%    $ref = $notes->{ $mod->GetId() };
     Notes:<br>
%    foreach $obj (@$ref) {
        &nbsp;&nbsp;&nbsp;&nbsp;
%       $bold = ($obj->{user} eq $mod->GetModeratorName()) ? 'bold' : 'body';
        <font class="<% $bold %>"><% $obj->{user} %></font>:
        <% $obj->{text} |n %><br> 
%    }
   </td>
</tr>
% }

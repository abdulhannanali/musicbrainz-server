This document describes the cache keys used by mb_server, and (in some cases)
the values thus stored.  Obviously it would be bad if different parts of the
server were to trample over each other's keys, so the aim of the game is to
ensure that none of the following regexes could ever conflict, i.e.:

   Every key-name must match EXACTLY ONE of the following regexes
   --------------------------------------------------------------

All stored values are complex Perl structures stored via Cache::Memcached (and
thus via Storable) unless otherwise specified.  Where objects are stored, the
"DBH" value is always omitted.

# Reserved, not yet implemented:
/^album-id-(\d+)$/ => \$album object where id=$1, \undef if none
/^album-mbid-($lc_guid)$/ => \$album object where gid=$1, \undef if none

# FIXME what are $type and $id?
/^annotation-($type)-($id)-lock$/ => used for annotation advisory locking

/^artist-id-(\d+)$/ => \$artist object where id=$1, \undef if none
/^artist-mbid-($lc_guid)$/ => \$artist object where gid=$1, \undef if none

/^country-all$/ - ref to array of hashrefs (list of countries)
/^country-id-(\d+)$/ - \$country object where id=$1, \undef if none

# FIXME host and query should be escaped
/^FreeDB-($host)-($port)-($query)$/ => FreeDB response cacheing

/^language-all$/ - ref to array of hashrefs (list of languages)
/^language-id-(\d+)$/ - \$language object where id=$1, \undef if none

/^Moderation(|-open|-closed)-id-range$/ => array ref of (minid, maxid)

/^moderator-id-(\d+)$/ => \$user object where id=$1, \undef if none
# Obsolete (can't easily be escaped):
# /^moderator-name-(.*)$/ => \$user object where name=$1, \undef if none

/^MusicBrainz::Server::Vote-AllVotesForUser_as_hashref-(\d+)$/
/^MusicBrainz::Server::Vote-RecentVotesForUser_as_hashref-(\d+)$/

/^newsfeed-($url)$/ - see MusicBrainz::Server::NewsFeed

/^script-all$/ - ref to array of hashrefs (list of scripts)
/^script-id-(\d+)$/ - \$script object where id=$1, \undef if none

# Reserved, not yet implemented:
/^track-id-(\d+)$/ - \$track object where id=$1, \undef if none
/^track-mbid-($lc_guid)$/ - \$track object where gid=$1, \undef if none

--------------------------------------------------------------------------------

The following keys are used by TRMGatewayHandler to implement throttling, and
to provide statistics which we plot later using MRTG.

"sigservers" - an integer, controlled with incr/decr.  The number of
		concurrent sigserver requests

These keys each store a simple integer.  TRMGatewayHandler increments these
values when certain events occur, then MRTG reads those values and resets them
to zero.

"trm-disabled" - the number of requests refused because the TRM "kill switch" is on
"trm-busy" - the number of requests refused because "sigservers" is over the throttle limit
"trm-nogateway" - the number of requests refused because we couldn't connect to the TRM gateway
"trm-error" - the number of requests failed due to a timeout, or some other error
"trm-ok" - the number of successful requests

These keys are used to measure the average response speed of the TRM server
(successful requests only).  MRTG reads them and resets them to zero.

"trm-taken" - the cumulative time taken for TRM requests, in microseconds.
"trm-taken-count" - the number of requests measured by "trm-taken"


<%args>
	$expand_lists => 0
	$script_curr => undef
	$language_curr => undef
</%args>

<%perl>

	my $mb = $m->comp("/comp/dblogin");

	my @scripts = MusicBrainz::Server::Script->Menu($mb->{DBH},
		minimum_frequency => ( $expand_lists ? 2 : 4 ),
		include => $script_curr
	);
	unshift @scripts, [ "-1", "Select script..." ];

	my @languages = MusicBrainz::Server::Language->Menu($mb->{DBH},
		minimum_frequency => ( $expand_lists ? 1 : 2 ),
		include => $language_curr
	);
	unshift @languages, [ "-1", "Select language..." ];

	my $result = {
		languages => \@languages,
		scripts => \@scripts,
		expand_lists => $expand_lists,
	};

	use JSON;
	my $json = new JSON;
	$r->content_type("text/plain; charset=utf-8");
	$m->out($json->encode($result));

</%perl>

%# vi: set ts=4 sw=4 ft=mason :

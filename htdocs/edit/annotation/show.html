%# vi: set ts=2 sw=2 ft=mason :
<%args>
$annotationid
</%args>
<%perl>

MusicBrainz::IsNonNegInteger($annotationid) && $annotationid
	or return $m->comp("/comp/badargs", 1, 1);

my $mb = $m->comp("/comp/dblogin");

my $annotation = MusicBrainz::Server::Annotation->new($mb->{DBH});
$annotation->SetId($annotationid);
$annotation->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Annotation #$annotationid does not exist",
		1, 1,
	);

my $ref = $m->comp('/edit/annotation/backreference', annotation => $annotation);

my $ar = $ref->{artist};
my $al = $ref->{album};
my $title = ( defined $al ) ? $al->GetName() : $ar->GetName();

</%perl>

<& /comp/sidebar, title => 'Annotation Detail' &>

<p>Annotation for <& /edit/annotation/subject, artist => $ar, album => $al &></p>

<p>Click <em>Show History</em> to see the history of all annotations
for this <% $annotation->GetTypeWord %>.</p>

<p>Click <em>Edit</em> to add a new annotation based on this one. The
annotation you see here will be left intact.</p>

<& /edit/annotation/show,
	annotation => $annotation,
	show_log => 1,
	history_link => 1,
	&>

<& /comp/footer &>

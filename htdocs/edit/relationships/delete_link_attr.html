%# vi: set ts=4 sw=4 ft=mason :
<%args>
$id
</%args>
<%perl>

$m->comp("/comp/checkloggedin", 1, 1)
	or return;

my $mb = $m->comp("/comp/dblogin");

my $link = MusicBrainz::Server::LinkAttr->new($mb->{DBH});

if (MusicBrainz::IsGUID($id))
{
	my $attr = $link->newFromMBId($id);
	if ($attr)
	{
		my $url = "/edit/relationships/link_attrs.html";
		$m->comp(
			"/comp/entermods",
			DBH => $mb->{DBH},
			sub => sub {
				my @mods = Moderation->InsertModeration(
					DBH		=> $mb->{DBH},
					uid		=> $session{uid},
					privs	=> $session{privs},
					type	=> &ModDefs::MOD_REMOVE_LINK_ATTR,
					# --
					node    => $attr,
				);
			},
			success_url => $url,
		) or return;

		die "Shouldn't get here";
	}
}
</%perl>

%# vi: set ts=4 sw=4 ft=mason :
<%args>
$id
$type
</%args>
<%perl>

$m->comp("/comp/checkloggedin", 1, 1)
	or return;

my $mb = $m->comp("/comp/dblogin");

my @types = split "-", $type;
my $link = MusicBrainz::Server::LinkType->new($mb->{DBH}, \@types);

if (MusicBrainz::Server::Validation::IsGUID($id))
{
	my $linktype = $link->newFromMBId($id);
	if ($linktype)
	{
		my $url = "/edit/relationships/link_types.html?type=$type";
		$m->comp(
			"/comp/entermods",
			DBH => $mb->{DBH},
			sub => sub {
				my @mods = Moderation->InsertModeration(
					DBH		=> $mb->{DBH},
					uid		=> $session{uid},
					privs	=> $session{privs},
					type	=> &ModDefs::MOD_REMOVE_LINK_TYPE,
					# --
					linktype=> $type,
					node    => $linktype,
				);
			},
			success_url => $url,
		) or return;

		die "Shouldn't get here";
	}
}
</%perl>

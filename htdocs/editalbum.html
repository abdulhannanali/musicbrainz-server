%# vi: set ts=2 sw=2 ft=mason :
<%args>
$album => undef
</%args>

<& /comp/sidebar, title => 'Edit Album Name' &>

<%perl>

$m->comp("/comp/checkloggedin", 0, 1)
	or return;

MusicBrainz::IsNonNegInteger($album) && $album
	or return $m->comp("/comp/badargs", 0, 1);

my $mb = $m->comp("/comp/dblogin");

my $al = Album->new($mb->{DBH});
$al->SetId($album);
$al->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Album #$album does not exist",
		0, 1,
	);

my $ar = Artist->new($mb->{DBH});
$ar->SetId($al->GetArtist);
$ar->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Artist does not exist",
		0, 1,
	);

</%perl>

<& /comp/stylemenu &>

<h2>Edit Album Name</h2>

% if ($al->GetModPending) {
	<& /comp/modpending &>
% }

<script type="text/javascript" src="scripts/guess.js"></script>

<form method="post" action="/bare/enter_mod.html" name="EditAlbumForm"
	enctype="application/x-www-form-urlencoded">

	<table width="100%">
		<tr>
			<td align="right">
				Current Name:
			</td>
			<td width="75%">
				<% $al->GetName %>
			</td>
		</tr>
		<tr>
			<td align="right">
				New Name:
			</td>
			<td width="75%">
				<input type="text" name="new0" size="50" value="<% $al->GetName %>">
			</td>
		</tr>
	</table>

	<p>
		<script type="text/javascript"><!--
		document.write(
			"<input type='button' value='Guess Case' " +
			"onclick='this.form.new0.value = GuessCase(this.form.new0.value)'>"
		);
		document.write(" &nbsp; ");
		//--></script>
		<input type="submit" value="Submit">
	</p>

	<input type="hidden" name="artist0" value="<% $ar->GetId  %>">
	<input type="hidden" name="type0" value="<% ModDefs::MOD_EDIT_ALBUMNAME %>">
	<input type="hidden" name="prev0" value="<% $al->GetName %>">
	<input type="hidden" name="table0" value="Album">
	<input type="hidden" name="column0" value="Name">
	<input type="hidden" name="id0" value="<% $al->GetId %>">
	<input type="hidden" name="url" value="/showalbum.html?albumid=<% $al->GetId %>">
</form>

<& /comp/movefocus, "EditAlbumForm", "new0" &>
<& /comp/footer &>

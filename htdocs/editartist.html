<& /comp/sidebar, title=>'Edit Artist Name', expand=>'moderate' &>

<%perl>

my ($mb, $id, $ar); 
my ($artistname, $referer, $modpending, $sortname); 

if (!exists $ARGS{id} || $ARGS{id} eq '') 
{
    mc_comp("/comp/badargs");
    return;
}

$id = $ARGS{id};
if ($id == Artist::VARTIST_ID)
{
    mc_out("You cannot edit this artist.\n");
    return;
}

$referer = $r->headers_in->{'Referer'};
$mb = new MusicBrainz;
$mb->Login();

$ar = Artist->new($mb->{DBH});
$ar->SetId($id);
$ar->LoadFromId();
$artistname = $ar->GetName();
$sortname = $ar->GetSortName();
$modpending = $ar->GetModPending();

</%perl>

% if (!defined $session{user} || $session{user} eq '') {
    You must be logged in to edit the database.<p>
    <& /comp/tablebegin, title=>'Login' &>
    <& /comp/loginbox &>
    <& /comp/tableend &>
% } else {

    <& /comp/tablebegin, gattrs=>"width=\"100%\"",
       title=>'Edit Artist Name' &>

% if ($modpending) {
    <& /comp/modpending &>
% }

    Use the fields below to enter a corrected name and/or sort name for
    this artist. If the the new artist name already exists in the database
    the Edit Artist Name modification will result in the Albums from the
    old artist name to get merged in with the Albums for the new artist
    name.<p>

    <FORM METHOD="POST" ACTION="/bare/enter_mod.html" NAME="EditArtistForm"
          ENCTYPE="application/x-www-form-urlencoded">  
    <table>
      <tr>
        <td>
        Current Name:
        </td>
        <td>
        <% $artistname  %>
        </td>
      </tr>
      <tr>
        <td>
        New Name:
        </td>
        <td>
        <INPUT TYPE="text" NAME="new0" SIZE=25 value="<% $artistname %>"> 
        </td>
      </tr>
      <tr>
        <td>
        Current Sort Name:
        </td>
        <td>
        <% $sortname  %>
        </td>
      </tr>
      <tr>
        <td>
        New Sort Name:
        </td>
        <td>
        <INPUT TYPE="text" NAME="new1" SIZE=25 value="<% $sortname %>"> 
        </td>
      </tr>
      <tr>
        <td>
        <INPUT TYPE="submit" NAME="Submit" VALUE="Submit">    
        </td>
        <td>
        <b>Note</b>: Please see below for an explanation of Sort Name.
        </td>
      </tr>
    </table>
    <input type="hidden" name="artist0" value="<% $id  %>">
    <input type="hidden" name="artist1" value="<% $id  %>">
    <input type="hidden" name="type0" 
           value="<% ModDefs::MOD_EDIT_ARTISTNAME  %>">
    <input type="hidden" name="type1" 
           value="<% ModDefs::MOD_EDIT_ARTISTSORTNAME  %>">
    <input type="hidden" name="prev0" value="<% $artistname  %>">
    <input type="hidden" name="prev1" value="<% $sortname  %>">
    <input type="hidden" name="table0" value="Artist">
    <input type="hidden" name="table1" value="Artist">
    <input type="hidden" name="column0" value="Name">
    <input type="hidden" name="column1" value="SortName">
    <input type="hidden" name="id0" value="<% $id %>">
    <input type="hidden" name="id1" value="<% $id %>">
    <input type="hidden" name="referer" value="<% $referer %>">
    </form>
    <& /comp/tableend &>

    <& /comp/stylenotes &>
    <& /comp/artiststylenotes &>
% }
% $mb->Logout();

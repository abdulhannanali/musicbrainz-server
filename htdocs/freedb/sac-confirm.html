%# vi: set ts=4 sw=4 ft=mason :
<%perl>

$session{"freedb_ready"}
	or return $m->comp("/comp/redirect", "/freedb/freedb.html");

my $ar = Artist->new(undef);
$ar->SetId($session{"freedb_artistid"});
$ar->SetName($session{'freedb_artist'});
$ar->SetSortName($session{'freedb_sortname'});

my $t = $session{"freedb_tracks"};

</%perl>
<& /comp/sidebar, title => "FreeDB Import - Confirm Import" &>

<p>
	You are about to add the following release to MusicBrainz:
</p>

	<table>
		<col>
		<col style="width: 0.5em">
		<col style="width: 20em">
		<tr>
			<td>Artist:</td>
			<td rowspan="<% $t+2 %>">
			<td>
% if ($ar->GetId) {
				<a href="/showartist.html?artistid=<% $ar->GetId %>"
					><% $ar->GetName %></a>
% } else {
				<% $ar->GetName %>
				(<% $ar->GetSortName %>)
% }
			</td>
		</tr>
		<tr>
			<td>Album:</td>
			<td><% $session{'freedb_album'} %></td>
		</tr>
% for my $i (0 .. $t-1) {
		<tr>
			<td>Track <% $i+1 %>:</td>
			<td><% $session{"freedb_track$i"} %></td>
		</tr>
% }
	</table>

<table>
	<tr>
		<td style="padding: 1em">
			<form method="post" action="/freedb/sac-edittracks.html">
				<p>
					<input type="submit" value="Keep Editing">
				</p>
			</form>
		</td>
		<td style="padding: 1em">
			<form method="post" action="/freedb/cancel.html">
				<p>
					<input type="submit" value="Abandon Import">
				</p>
			</form>
		</td>
		<td style="padding: 1em">
			<form method="post" action="/freedb/final.html">
				<p>
					<input type="submit" value="Continue">
				</p>
			</form>
		</td>
	</tr>
</table>

<& /comp/footer &>

%# vi: set ts=4 sw=4 ft=mason :
<%perl>

$session{"freedb_ready"}
	or return $m->comp("/comp/redirect", "/freedb/freedb.html");

my $ar = Artist->new(undef);
$ar->SetId($session{"freedb_artistid"});
$ar->SetName($session{'freedb_artist'});
$ar->SetSortName($session{'freedb_sortname'});

my $t = $session{"freedb_tracks"};

</%perl>
<& /comp/sidebar, title => "FreeDB Import: Confirm Import" &>

<fieldset>
	<legend>Review Artist and Track Names</legend>

	<div class="padleft">
		You are about to add the following release to MusicBrainz:
	</div>

	<div class="padlefttop">
		<table>
			<tr>
				<td><b>Artist:</td>
				<td rowspan="<% $t+2 %>">&nbsp;</td>
				<td>
% if ($ar->GetId) {
					<a href="/showartist.html?artistid=<% $ar->GetId %>"><% $ar->GetName %></a></td>
% } else {
					<% $ar->GetName %>
					(<% $ar->GetSortName %>)</td>
% }
			</tr>
			<tr>
				<td><b>Album:</b></td>
				<td><% $session{'freedb_album'} %></td>
			</tr>
% for my $i (0 .. $t-1) {
			<tr>
				<td><b><% $i+1 %>:</b></td>
				<td><% $session{"freedb_track$i"} %></td>
			</tr>
% }
		</table>
	</div>

	<div class="padlefttop">
		<table>
			<tr>
				<td>
					<form method="post" action="/freedb/sac-edittracks.html">
						<input type="submit" class="button" value="Keep Editing">
					</form></td>
				<td>
					<form method="post" action="/freedb/cancel.html">
						<input type="submit" class="button" value="Abandon Import">
					</form></td>
				<td>
					<form method="post" action="/freedb/final.html">
						<input type="submit" class="button" value="Continue">
					</form></td>
			</tr>
		</table>
	</div>
</fieldset>

<& /comp/footer &>

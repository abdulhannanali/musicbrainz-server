%# vi: set ts=2 sw=2 ft=mason :
<& /comp/sidebar, title=>'Merge Artist' &>
<%args>
$id => ""
</%args>
<%perl>

$m->comp("/comp/checkloggedin", 0, 1)
	or return;

($id || "") =~ /\A(\d{1,20})\z/
	or return $m->comp("/comp/badargs", 0, 1);

$id == ModDefs::DARTIST_ID
	and return $m->comp("/comp/badargs", 0, 1);

my $mb = mc_comp("/comp/dblogin");

my $ar = Artist->new($mb->{DBH});
$ar->SetId($id);
$ar->LoadFromId()
	or return $m->comp("/comp/badargs", 0, 1);

my $artistname = $ar->GetName();
my $sortname = $ar->GetSortName();
my $modpending = $ar->GetModPending();

</%perl>

    <& /comp/stylemenu &>

    <& /comp/tablebegin, title=>'Merge Artist' &>

% if ($modpending) {
    <& /comp/modpending &>
% }

    Use the field below to enter the artist <span class="bold">sortname</span>
    with whom to merge the current artist, then click Next &gt;&gt;.

    <FORM METHOD="POST" ACTION="/artistfilter.html" NAME="MergeArtistForm"
          ENCTYPE="application/x-www-form-urlencoded">  
    <table>
      <tr>
        <td>
        Artist:
        </td>
        <td>
        <% $artistname  %>
        </td>
      </tr>
      <tr>
        <td>
        Sortname of Artist<br> to Merge with:
        </td>
        <td>
        <INPUT TYPE="text" NAME="new0" SIZE=25 value="<% $artistname %>"> 
        </td>
      </tr>
      <tr>
        <td>
        <INPUT TYPE="submit" NAME="Submit" VALUE="Next &gt;&gt;">    
        </td>
        <td>
        &nbsp;
        </td>
      </tr>
    </table>
    <input type="hidden" name="mode" value="merge">
    <input type="hidden" name="artist0" value="<% $id  %>">
    <input type="hidden" name="type0" 
           value="<% ModDefs::MOD_MERGE_ARTIST  %>">
    <input type="hidden" name="prev0" value="<% $artistname %>">
    <input type="hidden" name="table0" value="Artist">
    <input type="hidden" name="column0" value="Name">
    <input type="hidden" name="id0" value="<% $id %>">
    <input type="hidden" name="url" value="/showartist.html?artistid=<% $id %>">
    <input type="hidden" name="artistfilter_dontshow" value="<% $id %>">
    </form>
    <& /comp/tableend &>

% $mb->Logout();

<& /comp/movefocus, "MergeArtistForm", "new0" &>
<& /comp/footer &>

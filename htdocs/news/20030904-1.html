%# vi: set ts=2 sw=2 ft=mason :
<& /comp/sidebar, title => 'September 4th, 2003: Server Updates', head => '
<style type="text/css">
ul, ol { padding-left: 0.7em }
li { margin-top: 0.5em; margin-bottom: 0.5em }
</style>
' &>

<h2>Changes mainly of interest to MusicBrainz Users</h2>

<ul>
	<li>
		The <a href="/style.html">Style Guide</a> has been updated.
	</li>
	<li>
		When moderations fail the ModBot user now adds a note
		to the moderation stating the reason for the failure; for
		example, "This album has already been renamed" or "This track has been
		deleted".&nbsp;
	</li>
	<li>
		While moderations remain open, the system now checks periodically to see
		if the moderations prerequisites and dependencies are still valid.&nbsp;
		If they are not, then the moderation is immediately closed, and the ModBot
		adds a note to explain what happened.&nbsp; So far this has been
		implemented for the most common moderation types; it will of course be
		extended to include all moderations in future releases.&nbsp; This change
		should help to solve most of the problems relating to dependencies between
		moderations.
	</li>
	<li>
		Moderation notes can now be longer than 255 characters.
	</li>
	<li>
		The page formerly known as "Browse 'Various Artist' Albums" is now known
		as "Browse Releases", and it can also browse single-artist releases
		too.&nbsp; For example, you can now browse
		<a href="/browsevarious.html?reltype=5&amp;relstatus=0&amp;artists=all&amp;index="
			>all soundtracks, regardless of artist</a>.
	</li>
	<li>
		When modifying your profile, it is now possible to remove your e-mail
		address from the system.
	</li>
	<li>
		<a href="/user/forgot-password.html">Forgot your password?&nbsp; We can
		e-mail it to you</a> (as long as you know your login name, and you've
		previously entered and confirmed your e-mail address).
	</li>
	<li>
		When entering track names, the input fields are now limited to 255
		characters, to match the limitation on the underlying database.&nbsp;
		Previously sometimes people would enter moderations to change the track
		name to something longer than 255 characters, but the moderation would
		then always fail.
	</li>
	<li>
		When <a href="/jumpmod.html">viewing a moderation in detail</a>, you
		can now see votes cast on your own moderations.
	</li>
	<li>
		A "Merge this album" link has been added to the main album display page
		(showalbum.html).&nbsp; If you get to the "Batch Operation" page with
		fewer than two albums tagged (i.e. "merge" is not available yet), then
		now a "Select more albums" link is also shown.&nbsp; Hopefully these two
		changes together make it more obvious how to merge albums.
	</li>
	<li>
		<a href="/stats.html">The statistics page</a> now includes a breakdown
		of open moderations by moderation type.
	</li>
	<li>
		Your <a href="/user/view.html">profile page</a> has moved.&nbsp;
		The "view" and "edit" profile pages are now separate.&nbsp;
		The "view" page now shows some voting statistics.&nbsp;
		You can now list other moderators' votes -
		<a href="/user/view.html?modname=djce">Try it!</a>.&nbsp;
		(Having said that though I'm not really happy with this feature yet,
		since it shows the other user's vote as being "your" vote,
		and then doesn't let you vote as a result.&nbsp; Caveat emptor.)
	</li>
</ul>

<p>
	Specific changes to particular moderations:
</p>

<ul>
	<li>
		When adding an artist alias, the system checks that the alias name
		does not already exist (for this, or any other, artist).&nbsp;
		MusicBrainz does not support duplicate aliases (yet).
	</li>
	<li>
		"Add Artist Alias" mods will fail (possibly before voting is over) if
		the alias name is seen to already exist, or the referenced artist is deleted.
	</li>
	<li>
		"Change Track Artist" mods will fail (possibly before voting is over)
		if the track is deleted or merged away,
		or the track's artist is changed by some other mod.
	</li>
	<li>
		"Edit Album Name" mods will fail (possibly before voting is over)
		if the album is deleted or merged away,
		or the album's name is changed by some other mod.
	</li>
	<li>
		"Edit Artist Name" mods will fail (possibly before voting is over)
		if the artist is deleted or merged away,
		or the artists's name is changed by some other mod,
		or an artist with exactly the same "new" name is found to exist.
	</li>
	<li>
		"Edit Track Name" mods will fail (possibly before voting is over)
		if the track is deleted or merged away,
		or the track's name is changed by some other mod.
	</li>
	<li>
		"Convert Album to Single Artist" mods will fail (possibly before voting is over)
		if the album is deleted or merged away,
		or the album is moved to another artist (i.e. not "Various Artists").
	</li>
	<li>
		"Merge Artists" mods will fail (possibly before voting is over)
		if the old artist is deleted or merged away,
		or the old artist's name is changed by some other mod,
		or the old and new artist are somehow the same,
		or the old artist is "Various Artists" or the "Deleted Artist",
		or no artist with the "new" name is found to exist,
		or the new artist is the "Deleted Artist".
	</li>
	<li>
		"Convert Album to Multiple Artists" mods will fail (possibly before voting is over)
		if the album is deleted or merged away,
		or the album is already "Various Artists" (changed by some other mod),
		or the album's artist is changed by some other mod.
	</li>
</ul>

<h2>Changes mainly of interest to MusicBrainz Programmers</h2>

<ul>
	<li>
		The 'showtrack.html' page now also accepts a '?mbid=<i>GUID</i>' argument,
		like the artist and album pages already did.&nbsp;
		<a href="/showtrack.html?mbid=5c5a0a30-2eb4-4823-b806-96e03f8eedaa">Try it</a>.
	</li>
	<li>
		Certain URLs can now be used to retrieve both the RDF and the HTML
		versions of the data; which is retrieved depends on the "Accept" HTTP
		header.&nbsp; Alternatively, the "?content-type" parameter can be
		specified to force the selection of a particular variant.&nbsp; For
		example:
		<ul>
			<li>
				<a href="/artist/084308bd-1654-436f-ba03-df6697104e19">Green Day</a>
				(HTML or RDF, depending on the "Accept" header)
			</li>
			<li>
				<a href="/album/02232360-337e-4a3f-ad20-6cdd4c34288c?content-type=text%2Fhtml">Little Earthquakes</a>
				(always HTML, regardless of the "Accept" header)
			</li>
			<li>
				<a href="/track/5ddf959d-2ee7-4e5d-9558-7c18a8a9ee00?content-type=text%2Fxml%2Brdf">Mozart "Jupiter" first movement</a>
				(always RDF, regardless of the "Accept" header)
			</li>
		</ul>
		The URLs that can be used in this way are:
		<ul>
			<li>/artist/<i>GUID</i></li>
			<li>/album/<i>GUID</i></li>
			<li>/track/<i>GUID</i></li>
			<li>/trm/<i>GUID</i></li>
			<li>/discid/<i>GUID</i></li>
		</ul>
	</li>
	<li>
		<a href="/products/server/docs/20030820-1/index.html"
			>New documentation</a> has been added.
	</li>
	<li>
		<a href="/docs/specs/metadata_tags.html"
			>Documentation has been updated</a>.
	</li>
</ul>

<h2>Changes mainly of interest to MusicBrainz Server Programmers</h2>

<ul>
	<li>
		When
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/admin/InitDb.pl">InitDb.pl</a>
		runs the various SQL scripts, it now timestamps the
		script output.&nbsp; By also adding the "--echo" argument (e.g.
		<kbd>./admin/InitDb.pl --createdb --echo --import *.tar.bz2</kbd>)
		the SQL commands are echoed too.&nbsp; These changes are intended to make
		it easier to see how the import is progressing, and to see why it's
		taking so damn long ;-)
		Also it no longer attempts to create the database user if it already
		exists.
	</li>
	<li>
		The "ModBot" code now lives in its own module, namely
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/cgi-bin/MusicBrainz/Server/ModBot.pm">MusicBrainz/Server/ModBot.pm</a>.&nbsp;
		It (via the
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/admin/CheckVotes.pl">./admin/CheckVotes.pl</a>
		script) now accepts command line arguments such as "--verbose".&nbsp;
		Sadly this doesn't include "--help" (yet), so just take a peek at the code
		to see what's on offer.
	</li>
	<li>
		The code which merges artists has moved from
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/cgi-bin/MusicBrainz/Server/Moderation/MOD_MERGE_ARTIST.pm">MOD_MERGE_ARTIST.pm</a>
		into
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/cgi-bin/Artist.pm">Artist.pm</a>
	</li>
	<li>
		The
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/cgi-bin/FreeDB.pm">FreeDB.pm</a>
		code has been tidied up a little.
	</li>
	<li>
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/cgi-bin/Sql.pm">Sql.pm</a>
		now complains if your use of "AutoCommit", "Begin", "Commit" and
		"Rollback" isn't to its liking.
	</li>
	<li>
		When a change is made to one of the style sheets, just run
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/admin/UpdateStyleSheetLinks">./admin/UpdateStyleSheetLinks</a>
		to force all clients to reload the style sheets next time around.
	</li>
	<li>
		A bug in
		<a href="http://cvs.musicbrainz.org/cvs/mb_server/htdocs/comp/topmodsbox">comp/topmodsbox</a>
		has been fixed whereby if there have been no
		moderations recently (e.g. on a development box), then the cache code
		failed, causing the component to (expensively) re-query the data on every
		request.
	</li>
	<li>
		&amp;DBDefs::DB_STAGING_SERVER is no longer just true or false.&nbsp;
		If it's true, it should be set to the name of the type of server this is,
		e.g. "development", "test", etc.
	</li>
</ul>

Dave Evans

<& /comp/footer &>

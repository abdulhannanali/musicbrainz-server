%# vi: set ts=4 sw=4 ft=mason :

<& /comp/sidebar-notitle, pagetitle=>"Install Firefox Search Plugins" &>

<& /comp/tablebegin, title=>"Install Firefox Search Plugins" &>

	Use the following links to install the Firefox/Mozilla search plugins. These plugins will allow
	you to search for MusicBrainz items directly from the browser:

	<div style="margin-top: 20px">
		<b>Lucene-Enabled Search Plugin for:</b>
		<br/>
		[
			<a href="javascript: addEngine('musicbrainzartist','gif','Arts')" title="Install Lucene-enabled Artists search plugin">Artists</a> |
			<a href="javascript: addEngine('musicbrainzrelease','gif','Arts')" title="Install Lucene-enabled Releases search plugin">Releases</a> |
			<a href="javascript: addEngine('musicbrainztrack','gif','Arts')" title="Install Lucene-enabled Tracks search plugin">Tracks</a>
		]
	</div>

	<div style="margin-top: 20px">
		<b>Old Search Plugin for:</b>
		<br/>
		[
			<a href="javascript: addEngine('musicbrainzartist-old','gif','Arts')" title="Install classic Artists search plugin">Artists</a> |
			<a href="javascript: addEngine('musicbrainzrelease-old','gif','Arts')" title="Install classic Releases search plugin">Releases</a> |
			<a href="javascript: addEngine('musicbrainztrack-old','gif','Arts')" title="Install classic Tracks search plugin">Tracks</a>
		]
	</div>

	<div style="margin-top: 20px">
		Should you want to remove these plugins, please follow these
		<a href="http://kb.mozillazine.org/Uninstall_search_plugins">instructions</a>.
	</div>

	<div>
		Thanks to Kim Plowright for creating these plugins!
	</div>

	<script type="text/javascript">
	<!--
		function errorMsg(name, ext, cat) {
			f=document.createElement("form");
			f.setAttribute("name","installform");
			f.setAttribute("method","post");
			f.setAttribute("action","http://<% &DBDefs::WEB_SERVER %>/search/plugins/firefox/error.html");
			fe=document.createElement("input");
			fe.setAttribute("type","hidden");
			fe.setAttribute("name","name");
			fe.setAttribute("value",name);
			f.appendChild(fe);
			fe=document.createElement("input");
			fe.setAttribute("type","hidden");
			fe.setAttribute("name","ext");
			fe.setAttribute("value",ext);
			f.appendChild(fe);
			fe=document.createElement("input");
			fe.setAttribute("type","hidden");
			fe.setAttribute("name","cat");
			fe.setAttribute("value",cat);
			f.appendChild(fe);
			document.getElementsByTagName("body")[0].appendChild(f);
			if (document.installform) {
				document.installform.submit();
			} else {
				// hack for unsupported browsers
				location.href="http://<% &DBDefs::WEB_SERVER %>/search/plugins/firefox/error.html";
			}
		}

		function addEngine(name, ext, cat) {
			if ((typeof window.sidebar == "object") &&
				(typeof window.sidebar.addSearchEngine == "function")) {
				//cat="Web";
				//cat=prompt("In what category should this engine be installed?","Web")
				window.sidebar.addSearchEngine(
				  "http://<% &DBDefs::WEB_SERVER %>/search/plugins/firefox/"+name+".src",
				  "http://<% &DBDefs::WEB_SERVER %>/search/plugins/firefox/"+name+"."+ext,
				  name,
				  cat
				);
			} else {
				errorMsg(name,ext,cat);
			}
		}
	//-->
	</script>


<& /comp/tableend &>
<& /comp/footer &>

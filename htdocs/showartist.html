<& /comp/sidebar &>
<%perl>

my ($mb); 
my (@info, $artistname, $albumname, $modpending);
my ($trackinfo, $albumid, @idsalbums, $i, $j, $ar, $al); 

if (!exists $ARGS{artistid} || $ARGS{artistid} eq '')
{
    mc_comp("/comp/badargs");
    return;
}

$mb = new MusicBrainz;
$mb->Login();
$ar = Artist->new($mb);
$al = Album->new($mb);

if (! $ar->LoadFromId($ARGS{artistid}))
{
    mc_out("This artist (id=$ARGS{artistid}) was not found in the database.");
}
elsif ($ARGS{artistid} == Artist::VARTIST_ID)
{
    mc_out("You cannot view all Various Artist albums using this page. Sorry.");
}
else
{
    $artistname = $ar->Value(1);
    $modpending = $ar->Value(3);

    @idsalbums = $ar->GetAlbumList($ARGS{artistid});
    
    mc_comp("/comp/artisttitle", 
            artistname=>$artistname, 
            artistid=>$ARGS{artistid},
            modpending=>$modpending);
    mc_comp("/comp/modnotice");
    
    for(;;)
    {
        $albumid = shift @idsalbums;
        last if (! defined $albumid);
        $albumname = shift @idsalbums;
        $modpending = shift @idsalbums;
    
        mc_comp("/comp/album", 
                mb=>$mb,
                albumid=>$albumid, 
                artist=>$ARGS{artistid},
                albumname=>$albumname,
                modpending=>$modpending);
    }
    
    @idsalbums = $ar->GetMultipleArtistAlbumList($ARGS{artistid});
    for(;;)
    {
        $albumid = shift @idsalbums;
        last if (! defined $albumid);
        $albumname = shift @idsalbums;
        $modpending = shift @idsalbums;
    
        mc_comp("/comp/malbum", 
                mb=>$mb,
                albumid=>$albumid, 
                albumname=>$albumname,
                modpending=>$modpending);
    }
}

$mb->Logout();

</%perl>

<& /comp/sidebar &>

<%perl>
if (DBDefs::USE_LYRICS) {
  my ($mb, $ly, $tr, $ar); 
  my ($trackid, @trackdata, @syncevents);

  if (!exists $ARGS{id} || $ARGS{id} eq '')
  {
      mc_comp("/comp/badargs");
      return undef;
  }
  
  $mb = new MusicBrainz;
  $mb->Login();

  $tr = Track->new($mb->{DBH});
  $ar = Artist->new($mb->{DBH});
  $ly = Lyrics->new($mb->{DBH});

  @syncevents = $ly->GetSyncEventList($ARGS{id});
  ($trackid)  = $ly->GetSyncTextData($ARGS{id});
  $tr->SetId($trackid);
  $tr->LoadFromId();
  $tr->SetId($tr->GetArtist());
  $ar->LoadFromId();
  if ((scalar(@syncevents) > 0)) {
  </%perl>
      <& /comp/syncevents, trackname=>$tr->GetName(),
                    artistname=>$ar->GetName(),
                    syncevents=>\@syncevents &>
% } else {
      There were no items found. Please try again.<p>
% }
% $mb->Logout();
%}
<& /comp/footer &>

%# vi: set ts=2 sw=2 ft=mason :
<%args>
$album => undef
</%args>

<& /comp/sidebar, title => 'Convert Album to Multiple Artists' &>

<%perl>

$m->comp("/comp/checkloggedin", 0, 1)
	or return;

MusicBrainz::IsNonNegInteger($album) && $album
	or return $m->comp("/comp/badargs", 0, 1);

my $mb = $m->comp("/comp/dblogin");

my $al = Album->new($mb->{DBH});
$al->SetId($album);
$al->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Album #$album does not exist",
		0, 1,
	);

my $ar = Artist->new($mb->{DBH});
$ar->SetId($al->GetArtist);
$ar->LoadFromId
	or return $m->comp(
		"/comp/error",
		"Artist does not exist",
		0, 1,
	);

</%perl>

<h2>Convert Album '<% $al->GetName %>' to Multiple Artists</h2>

<p>
 	A single artist to multiple artist moderation will be entered
	into the database for album
	<a href="/showalbum.html?albumid=<% $al->GetId %>"><% $al->GetName %></a>.
</p>

<p>
	Would you like to move all of the tracks to new artists?
</p>

<form method="post" action="/bare/enter_mod.html" name="ToMacForm"
	enctype="application/x-www-form-urlencoded">

	<p>
		<input type="radio" name="choice" value="yes" checked
			ondblclick="this.form.submit()"
			>
		Yes, move tracks now.
		<br>
		<input type="radio" name="choice" value="no"
			ondblclick="this.form.submit()"
			>
		No, leave it for later.
	</p>

	<p>
		<input type="submit" value="Submit">
	</p>

	<input type="hidden" name="artist0" value="<% $ar->GetId %>">
	<input type="hidden" name="type0" value="<% ModDefs::MOD_SAC_TO_MAC %>">
	<input type="hidden" name="new0" value="Various Artists">
	<input type="hidden" name="prev0" value="<% $ar->GetName() %>">
	<input type="hidden" name="table0" value="Album">
	<input type="hidden" name="column0" value="Artist">
	<input type="hidden" name="id0" value="<% $al->GetId %>">
	<input type="hidden" name="url" value="/changetrack.html?album=<% $al->GetId %>&amp;artist=<% $ar->GetId %>&amp;tindex=0&amp;modid=0">
	<input type="hidden" name="alturl" value="/showalbum.html?albumid=<% $al->GetId %>">
</form>

<& /comp/movefocus, "ToMacForm", "choice", 0 &>
<& /comp/footer &>

<& /comp/sidebar, title=>'Convert Album to Multiple Artists',
   expand=>'moderate' &>

<%perl>

my ($mb, $id, $albumname, $modpending);
my ($artistname, $al, $artist, $ar, $track); 

if (!exists $ARGS{album} || $ARGS{album} eq '' ||
    !exists $ARGS{artist} || $ARGS{artist} eq '' ||
    !exists $ARGS{track} || $ARGS{track} eq '')
{
    mc_comp("/comp/badargs");
    return undef;
}

$mb = mc_comp("/comp/dblogin");
$id = $ARGS{album};
$artist = $ARGS{artist};
$track = $ARGS{track};

$al = Album->new($mb->{DBH});
$al->SetId($id);
$al->LoadFromId();

$ar = Artist->new($mb->{DBH});
$ar->SetId($artist);
$ar->LoadFromId();

$albumname = $al->GetName();
$modpending = $al->GetModPending();
$artistname = $ar->GetName();

</%perl>

% if (!defined $session{user} || $session{user} eq '') {
    You must be logged in to edit the database.<p>
    <& /comp/tablebegin, title=>'Login' &>
    <& /comp/loginbox &>
    <& /comp/tableend &>
% } else {

    <& /comp/tablebegin, gattrs=>"width=\"100%\"",
       title=>"Convert Album $albumname to Multiple Artists" &>

    A single artist to multiple artist moderation will be entered
    into the database for album <% $albumname %>.

    <FORM METHOD="POST" ACTION="/bare/enter_mod.html" NAME="ToMacForm"
          ENCTYPE="application/x-www-form-urlencoded">  
    <table>
      <tr>
        <td>
        Would you like to move all<br> of the tracks to new artists?
        </td>
        <td>
        <INPUT TYPE="radio" NAME="choice" VALUE="yes" CHECKED>
        Yes, move tracks now.
        </td>
      </tr>
      <tr>
        <td>
        &nbsp;
        </td>
        <td>
        <INPUT TYPE="radio" NAME="choice" VALUE="no">
        No, leave it for later.    
        </td>
      </tr>
      <tr>
        <td colspan=2>
        <INPUT TYPE="submit" NAME="Submit" VALUE="Submit">    
        </td>
      </tr>
    </table>
    <input type="hidden" name="artist0" value="<% $artist %>">
    <input type="hidden" name="type0" 
           value="<% ModDefs::MOD_SAC_TO_MAC %>">
    <input type="hidden" name="new0" value="Various Artists">
    <input type="hidden" name="prev0" value="<% $albumname  %>">
    <input type="hidden" name="table0" value="Album">
    <input type="hidden" name="column0" value="Artist">
    <input type="hidden" name="id0" value="<% $id %>">
    <input type="hidden" 
           name="url" 
           value="/changetrack.html?album=<% $id %>&artist=<% $artist %>&tindex=0&modid=0">
    <input type="hidden" name="alturl" 
           value="/showalbum.html?albumid=<% $id %>">
    </form>
      
    <& /comp/tableend &>
% }
% $mb->Logout();
<& /comp/footer &>
